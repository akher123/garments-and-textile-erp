@model SCERP.Web.Areas.Accounting.Models.ViewModels.AccountingReportViewModel

@{
    ViewBag.Title = "Cash Book";
    Layout = "~/Views/Shared/_Layout2.cshtml";
}

<div class="header-title">
    <h2>Cash Book</h2>
</div>

<section class="common-search-section">
    <div class="search formCover common-search-wrapper">

        @using (Html.BeginForm("CashBook", "Report", FormMethod.Get, new { @class = "CashBookLedgerForm" }))
        {

        <table class="tabefont">
            <tr>
                <td>@Html.DisplayName("Date: ")</td>
                <td>@Html.TextBoxFor(x => x.FromDate, new { @class = "datepicker", placeholder = "From Date" })</td>
                <td>@Html.TextBoxFor(x => x.ToDate, new { @class = "datepicker", placeholder = "To Date" })</td>
            </tr>
            <tr>
                <td>@Html.DisplayName("Account Head: ")</td>
                <td>
                    @Html.TextBoxFor(p => p.SearchString, new { id = "vd_AccountName"})
                    @Html.HiddenFor(p => p.GlId, new { id = "cash_glId"})
                </td>
                <td>
                    <div class="dropdown">
                        <button class="dropbtn">CASH BOOK ▼</button>
                        <div class="dropdown-content">
                            <a style="cursor: pointer" target="_blank" onclick="printCashBook(1)">PDF</a>
                            <a style="cursor: pointer" target="_blank" onclick="printCashBook(3)">EXCEL</a>
                        </div>
                    </div>
                </td>
            </tr>
        </table>

        }
    </div>
</section>


@section styles
{
<link href="~/Content/Common/SingleDropdownMenu.css" rel="stylesheet" />
}

@section scripts
{
<script type="text/javascript">
    $('#vd_AccountName').autocomplete({
        source: function (request, response) {
            var option = {
                url: "/VoucherEntry/AutocompliteGLAccount",
                type: "POST",
                data: { accountName: request.term },
            };
            $.Ajax(option)
                .done(function (data) {
                    response($.map(data, function (item) {
                        return { label: item.AccountName, value: item.AccountName + "-" + item.AccountCode, GLID: item.Id };
                    }));
                });
        },
        select: function (event, ui) {
            $('#cash_glId').val(ui.item.GLID);


        },
    });

    function printCashBook(rId) {

        var url = '/Accounting/Report/PrintCashBook?';

        var form = $('.CashBookLedgerForm');
        if (jQuery.validator && jQuery.validator.unobtrusive) {
            form.validate();
            if (!form.valid()) {
                return false;
            } else {
                var data = form.serialize();
                var searchurl = url + data;
                window.open(searchurl);
            }
        }
    }

</script>
}

