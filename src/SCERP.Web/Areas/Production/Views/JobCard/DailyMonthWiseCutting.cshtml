@using System.Data
@model SCERP.Web.Areas.Production.Models.ProductionReportViewModel
@{
    Layout = "~/Views/Shared/_Layout.Dialog.cshtml";
    ViewBag.Title = "DAY AND MONTH WISE CUTTING";
}
@section styles
{
    <link href="~/Content/Common/SingleDropdownMenu.css" rel="stylesheet" />
}
<div class="header-title">
    <h2>DAY AND MONTH WISE CUTTING PRODUCTION</h2>
</div>
<section class="common-search-section">
    <div class="search formCover common-search-wrapper">
        @using (Html.BeginForm("DailyMonthWiseCutting", "JobCard", FormMethod.Post, new { @class = "DailyMonthWiseCuttingForm ignore-validation" }))
        {
            @Html.HiddenFor(x => x.IsSearch)
            <table>
                <tr>
                    <td>
                        @Html.Label("Year")
                    </td>
                    <td>
                        @Html.DropDownListFor(x => x.YearId, Model.YearSelectListItem)
                    </td>
                    <td>
                        <input type="button" class="searchAction"/>

                    </td>
                  
                </tr>
            </table>
        }
    </div>
</section>

<section class="search formCover">
    <div class="additem">
        <div class="addButton-wrapper">
            <div class="dropdown">
                <button class="dropbtn">REPORT▼</button>
                <div class="dropdown-content">
                    <a style="cursor: pointer" target="_blank" onclick="GetDailyMonthWiseCuttingReport(1)">PDF</a>
                    <a style="cursor: pointer" target="_blank" onclick="GetDailyMonthWiseCuttingReport(3)">Excel</a>
                </div>
            </div>
        </div>
  
        <table class="webgrid-table">
            <thead class="webgrid-header">
                <tr class="text-center">
                    @foreach (DataColumn col in Model.DataTable.Columns)
                    {
                        <th>@col.ColumnName</th>
                    }

                </tr>
            </thead>
            <tbody>
                @foreach (DataRow row in Model.DataTable.Rows)
                {
                    <tr>
                        @foreach (DataColumn col in Model.DataTable.Columns)
                        {

                            <td>@row[col.ColumnName]</td>
                        }
                    </tr>
                }


            </tbody>
        </table>
    </div>
</section>

@section scripts
{

    <script type="text/javascript">
        function GetDailyMonthWiseCuttingReport(rptType) {
            var form = $('.DailyMonthWiseCuttingForm');
            if (jQuery.validator && jQuery.validator.unobtrusive) {
                form.validate();
                if (!form.valid()) {

                    return false;
                } else {
                    var data = form.serialize();
                    var searchurl = '/ProductionReport/DailyMonthWiseCuttingReport?' + data + "&rptType=" + rptType;
                    window.open(searchurl);
                }
            }
        }
    </script>
}