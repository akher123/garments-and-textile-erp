@using System.Data
@model SCERP.Web.Areas.Production.Models.ProductionReportViewModel
@{
    Layout = "~/Views/Shared/_InventoryLayout.cshtml"; 
}
@section styles
{
    <link href="~/Content/Common/SingleDropdownMenu.css" rel="stylesheet" />
}
<div class="header-title">
    <h2>Daily Production Summary Status </h2>
</div>
<section class="common-search-section">
    <div class="search formCover common-search-wrapper">
        @using (Html.BeginForm("CuttSummary", "ProductionReport", FormMethod.Get, new { @class = "CuttSummarySearchForm ignore-validation" }))
        {
            @Html.HiddenFor(x => x.IsSearch)
            <table>
                <tr>
                    <td>
                        @Html.Label("Date :")
                    </td>
                    <td>
                        @Html.TextBoxFor(x => x.CuttingBatch.CuttingDate, new { @class = "datepicker" })
                    </td>
                    <td>
                        @Html.Label("*", new { @class = "labelInstruction" })
                    </td>
                    <td>
                        <input type="button" class="searchAction" />
                    </td>
                    <td>
                        <div class="dropdown">
                            <button class="dropbtn">REPORT▼</button>
                            <div class="dropdown-content">
                                <a style="cursor: pointer" target="_blank" onclick="DailyProductionStatusSummary(3)">Excel</a>
                            </div>
                        </div>
                    </td>
                </tr>
            </table>
        }

    </div>
</section>

<section class="search formCover">
    <div class="additem">
        <table class="webgrid-table">
            <thead class="webgrid-header">
                <tr>

                    <td>Buyer</td>
                    <td>Order</td>
                    <td>Style</td>
                    <td>Color</td>
                    <td>Order Qty</td>
                    <td>T/Day Cutt Qty</td>
                    <td>Total Cutt Qty</td>
                    <td>Panel Reject Qty</td>
                    <td>Final Cutt Qty</td>
                    <td>Final Cutt (%)</td>
                    <td>Print Sent</td>
                    <td>Print Rcv</td>
                    <td>Print Rcv/Balance</td>
                    <td>Emb Sent</td>
                    <td>Emb Rcv</td>
                    <td>Emb Rcv/Balance</td>
                    <td>T/Day Input</td>
                    <td>TTL Input</td>
                    <td>CutBank</td>
                    <td>T/Day Sewing Output</td>
                    <td>TTL Sewing Output</td>
                    <td>Sewing WIP</td>
                </tr>
            </thead>
            <tbody>
                @foreach (System.Data.DataRow row in Model.DataTable.Rows)
                {
                    <tr>
                        @foreach (var cell in row.ItemArray)
                        {
                            <td>@cell.ToString()</td>
                        }
                    </tr>
                }
            </tbody>
        </table>
    </div>
</section>


@section scripts
{

    <script type="text/javascript">

       
        function DailyProductionStatusSummary(reportType) {
            var form = $('.CuttSummarySearchForm');
            if (jQuery.validator && jQuery.validator.unobtrusive) {
                form.validate();
                if (!form.valid()) {

                    return false;
                } else {
                    var data = form.serialize();
                    var searchurl = '/ProductionReport/DailyProductionStatusSummaryReport?' + data + '&ReportType=' + reportType;
                    window.open(searchurl);
                }
            }


        }
    </script>
}