@using System.Data
@model SCERP.Web.Areas.MIS.Models.ViewModel.MisDashboardViewModel
@{
    Layout = "~/Views/Shared/_Layout.Dialog.cshtml";
    ViewBag.Title = "ORDER STATUS FOR " + Model.BuyerWiseOrderStyleDtable.Rows[0][0];
    Model.BuyerWiseOrderStyleDtable.Columns.RemoveAt(0);
}

<table class="webgrid-table">
    <thead class="webgrid-header">

        <tr>
            @foreach (DataColumn col in Model.BuyerWiseOrderStyleDtable.Columns)
            {
                if (!col.ColumnName.Equals("STATUS"))
                {
                    <th>@col.ColumnName</th>
                }
            }
        </tr>
    </thead>
    <tbody>
        @foreach (DataRow row in Model.BuyerWiseOrderStyleDtable.Rows)
        {
            <tr>
                @foreach (DataColumn col in Model.BuyerWiseOrderStyleDtable.Columns)
                {
                    if (col.ColumnName.Equals("ORDER") || col.ColumnName.Equals("ORDER QTY") || col.ColumnName.Equals("VALUE") || col.ColumnName.Equals("REMARKS"))
                    {
                        <td style="background:@row["STATUS"]">@row[col.ColumnName]</td>
                    }
                    else
                    {
                        if (col.ColumnName.Equals("TNA"))
                        {
                            <td>
                                <a style="color: purple;cursor: pointer" class="AjaxPopup" action="/MIS/MisDashboard/TnaDetail?orderStyleRefId=@row["OrderStyleRefId"]">@row[col.ColumnName]</a>
                            </td>


                        }
                        else if (col.ColumnName.Replace(" ", "").Equals("COSTSHEET"))
                        {
                            <td>
                                <a style="color: purple;cursor: pointer" href="/Merchandising/Report/CostSheet?OrderStyleRefId=@row["OrderStyleRefId"]&&isMail=false" target="_blank">@row[col.ColumnName]</a>
                            </td>


                        }
                        else if (col.ColumnName.Equals("FAB_BOM"))
                        {
                            <td>
                                @Html.ActionLink("" + @row[col.ColumnName] + "", "StyleWiseFabrConsumtionDetail", "Consumption", new { Area = "Merchandising", OrderStyleRefId = @row["OrderStyleRefId"], IsShowReport = true, ReportType = 1 }, new { target = "_blank", style = "color: purple;cursor: pointer" })
                            </td>
                        }
                        else if (col.ColumnName.Equals("ACC_BOM"))
                        {
                            <td>
                                @Html.ActionLink("" + @row[col.ColumnName] + "", "StyleWiseConsumtionDetail", "Consumption", new { Area = "Merchandising", OrderStyleRefId = @row["OrderStyleRefId"], IsShowReport = true, ReportType = 1 }, new { target = "_blank", style = "color: purple;cursor: pointer" })
                            </td>
                        }
                        else if (!col.ColumnName.Equals("STATUS"))
                        {

                            <td onclick="selectStyle('@row["OrderStyleRefId"]','@row["STYLE"]',this)">@row[col.ColumnName]</td>
                        }
                    }

                }
            </tr>
        }
        <tr style="background-color:#b0c4de">
            <td colspan="4">TOTAL </td>
            <td>@Model.BuyerWiseOrderStyleDtable.Compute("sum([" + "ORDER QTY" + "])", "").ToString()</td>
            <td></td>
            <td>@Model.BuyerWiseOrderStyleDtable.Compute("sum([" + "VALUE($)" + "])", "").ToString()</td>

            <td>@Model.BuyerWiseOrderStyleDtable.Compute("sum([" + "SHIP QTY" + "])", "").ToString()</td>
            <td>@Model.BuyerWiseOrderStyleDtable.Compute("sum([" + "BALANCE QTY" + "])", "").ToString()</td>
        </tr>
    </tbody>
</table>

